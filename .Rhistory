rm(list = ls())
gc()
# paquetes ----------------------------------------------------------------
library(tidyverse)
library(readxl)
library(janitor)
library(haven)
select <- dplyr::select
rename <- dplyr::rename
# * listado de comunas ----------------------------------------------------
codigo_comuna <- read_excel("2022/datos/0_raw_data/diseno_muestral/codigo_comuna.xlsx") %>%
filter(cod_comuna != 99999 & cod_comuna != 88888 & cod_comuna != 12202) %>%  # sin antártica y códigos mal especificados
rename(comuna = cod_comuna, nombre_comuna = comuna)
base_fh_2020 <- readRDS("C:/Users/gsotomayor/Desktop/Diplomado/Trabajo APPDD/base_fh_2020.rds")
base_fh_2020 <- readRDS("base_fh_2020.rds")
base_fh_2020$brecha<-(base_fh_2020$promedio_afc_hom_2020-base_fh_2020$promedio_afc_muj_2020)/base_fh_2020$promedio_afc_hom_2020*100
base_fh_2020[order(base_fh_2020$brecha),c("comuna","brecha")]
hist(base_fh_2020$brecha)
lm1<-lm(brecha~.,data=base_fh_2020[,c(2:19,105:124,364)])
library(texreg)
base_fh_2020$tasa_victimizacion_2019
screenreg(lm(brecha~prop_rural_2020+
prop_poblacion_pueblos_originarios_ley_chile_2017+
tasa_dependencia_familiar_2020+
tasa_matricula_neta_parvularia_2020+
promedio_anios_escolaridad25_2017+
I(proyeccion_pob_0_17_anios_2020/proyeccion_pob_2020)+
log_ing_municipales_permanentes_pc_2018+
prop_fonasa_a_hom_2019+
prop_fonasa_a_muj_2019+
log(promedio_pet_afc_2020+
prop_tofd_2020_w)+
prop_ive_sinae_2020+
log(tasa_victimizacion_2019),data=base_fh_2020
))
base_fh_2020$log_ing_municipales_permanentes_pc_2018
step_lm1 <- stepAIC(lm1, direction = "both",
trace = FALSE)
summary(step_lm1)
library(MASS)
base_fh_2020$brecha<-(base_fh_2020$promedio_afc_hom_2020-base_fh_2020$promedio_afc_muj_2020)/base_fh_2020$promedio_afc_hom_2020*100
step_lm1 <- stepAIC(lm1, direction = "both",
trace = FALSE)
summary(step_lm1)
lm1<-lm(brecha~prop_rural_2020+
prop_poblacion_pueblos_originarios_ley_chile_2017+
tasa_dependencia_familiar_2020+
tasa_matricula_neta_parvularia_2020+
promedio_anios_escolaridad25_2017+
I(proyeccion_pob_0_17_anios_2020/proyeccion_pob_2020)+
log_ing_municipales_permanentes_pc_2018+
prop_fonasa_a_hom_2019+
prop_fonasa_a_muj_2019+
log(promedio_pet_afc_2020+
prop_tofd_2020_w)+
prop_ive_sinae_2020+
log(tasa_victimizacion_2019),data=base_fh_2020
)
step_lm1 <- stepAIC(lm1, direction = "both",
trace = FALSE)
summary(step_lm1)
